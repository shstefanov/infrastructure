include ../../../mixins/docs.jade
//- Creates tab button. first is by default 'active'
//- +doc_example_tab_items("states_root", {
//-   "cli":     "cli", 
//-   "package": "package.json"
//- })

//- Create tab content item
//- locals.getContentStateTemplate("states_root.cli") gets state template generated by doc_example_tab_items
//- div(class!=locals.getContentStateTemplate("states_root.cli")): pre: code.language-bash.
//-   npm install infrastructure
  
//- div(class!=locals.getContentStateTemplate("states_root.package")): pre: code.language-javascript.
//-   "dependencies": {
//-     "infrastructure": "^1.0.0"
//-   }

include ../../../mixins/fs_ui.jade


.page-header: h1 Process modes

+doc_example_tab_items("process_modes_1", {
  "app_js":             "in app.js",
  "in_configuration":   "in configuration",
  "cli":                "cli",
})
div.code-block.large(class!=locals.getContentStateTemplate("process_modes_1.app_js")): pre: code.language-javascript.
  var infrastructure = require("infrastructure");
  infrastructure({ process_mode: "cluster" }, function(err, env) {
    if (err) { throw err; }
  });
div.code-block.large(class!=locals.getContentStateTemplate("process_modes_1.in_configuration"))
  .col-xs-2.fs-block
    +fs_block("process_modes_fs_1", {
      "app.js" :                      false,
      "config/structures/log.json":   false,
      "config/process_mode.json":     true,
    })
  .col-xs-10.code-block.large(class!=locals.getStateFromFs("process_modes_fs_1", "app.js")): pre: code.language-javascript.
    var infrastructure = require("infrastructure");
    infrastructure({ /* Write config here */ }, function(err, env) {
      if (err) { throw err; }
    });

  .col-xs-10.code-block.large(class!=locals.getStateFromFs("process_modes_fs_1", "config/process_mode.json")): pre: code.language-javascript.
    "cluster"

  .col-xs-10.code-block.large(class!=locals.getStateFromFs("process_modes_fs_1", "config/structures/log.json")): pre: code.language-javascript.
    {
      "engines": [ "log" ],
      "options": { "sys": true, "debug": true }
    }

div.code-block.large(class!=locals.getContentStateTemplate("process_modes_1.cli")): pre: code.language-bash.
  $> node app
  [sys]  [2015-11-09 20:49:00][logger]........................... options: sys, debug
  [sys]  [2015-11-09 20:49:00][worker]........................... log
  [sys]  [2015-11-09 20:49:00][worker started]................... 56ms, structures: log
  [sys]  [2015-11-09 20:49:00][application started].............. 466ms, process_mode: cluster, application mode: undefined